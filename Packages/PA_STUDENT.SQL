--------------------------------------------------------
--  File created - Thursday-February-15-2018   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Package PA_STUDENT
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VB"."PA_STUDENT" 
AS
  PROCEDURE S_STUDENT(
      nID    IN STUDENT.STUD_ID%TYPE,
      sNAME  IN STUDENT.NAME%TYPE,
      nCLASS IN STUDENT.CLASS_ID%TYPE,
      STUD_REC OUT SYS_REFCURSOR);
      
  PROCEDURE GET_STUDENT_ROLL(
      nUSER_ID IN STUDENT.USER_ID%TYPE,
      STUD_REC OUT SYS_REFCURSOR,
      nRETURNCODE OUT NUMBER);
      
  PROCEDURE GET_STUDENT_FROM_SCHOOL(
      nCLASS_ID IN STUDENT.CLASS_ID%TYPE,
      STUD_REC OUT SYS_REFCURSOR,
      nRETURNCODE oUT NUMBER);
      
END PA_STUDENT;

/




create or replace PACKAGE BODY PA_STUDENT AS PROCEDURE S_STUDENT( nID IN STUDENT.STUD_ID%TYPE, sNAME IN STUDENT.NAME%TYPE, nCLASS IN STUDENT.CLASS_ID%TYPE, STUD_REC OUT SYS_REFCURSOR) AS BEGIN BEGIN OPEN STUD_REC FOR SELECT STUD_ID , NAME , CLASS_ID , PARENTS_CONTACT_NO, ADDRESS FROM STUDENT WHERE (nID IS NULL OR nID=0 OR nID=STUD_ID) AND (sName IS NULL OR NAME LIKE '%' || sName ||'%') AND (nClass IS NULL OR nClass=0 OR nClass=CLASS_ID); END; END S_STUDENT; PROCEDURE GET_STUDENT_ROLL( nUSER_ID IN STUDENT.USER_ID%TYPE, STUD_REC OUT SYS_REFCURSOR, nRETURNCODE OUT NUMBER) AS BEGIN nRETURNCODE:=0; BEGIN OPEN STUD_REC FOR SELECT STUD_ID , NAME , USER_ID FROM STUDENT WHERE (nUSER_ID = USER_ID); END; EXCEPTION WHEN OTHERS THEN nRETURNCODE:=-21; END GET_STUDENT_ROLL; PROCEDURE GET_STUDENT_FROM_SCHOOL( nCLASS_ID IN STUDENT.CLASS_ID%TYPE, STUD_REC OUT SYS_REFCURSOR, nRETURNCODE OUT NUMBER) AS BEGIN nRETURNCODE := 0; BEGIN IF (nCLASS_ID = 0) THEN BEGIN OPEN STUD_REC FOR SELECT STUD_ID FROM STUDENT; END; ELSE BEGIN OPEN STUD_REC FOR SELECT STUD_ID FROM STUDENT WHERE nCLASS_ID = CLASS_ID; END; END IF; EXCEPTION WHEN OTHERS THEN nRETURNCODE := -23; END; END GET_STUDENT_FROM_SCHOOL; END PA_STUDENT;

