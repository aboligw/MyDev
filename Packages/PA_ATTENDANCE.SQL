--------------------------------------------------------
--  File created - Thursday-February-15-2018   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Package PA_ATTENDANCE
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VB"."PA_ATTENDANCE" 
AS
  
  PROCEDURE S_ATTENDANCE(
      nCLASS_ID   IN LECTURE.CLASS_ID%TYPE,
      nLEC_NUM  IN LECTURE.LEC_NUM%TYPE,
      nTEACER_ID IN LECTURE.TEACHER_ID%TYPE,
      DATA_REC OUT SYS_REFCURSOR,
      nRETURNCODE OUT NUMBER);
      
      PROCEDURE S_MYATTENDANCE(
      nSTUD_ID IN STUDENT.STUD_ID%TYPE,
      DATA_REC OUT SYS_REFCURSOR,
      nRETURNCODE OUT NUMBER);
  
END PA_ATTENDANCE;

/

create or replace PACKAGE BODY PA_ATTENDANCE AS PROCEDURE S_ATTENDANCE( nCLASS_ID IN LECTURE.CLASS_ID%TYPE, nLEC_NUM IN LECTURE.LEC_NUM%TYPE, nTEACER_ID IN LECTURE.TEACHER_ID%TYPE, DATA_REC OUT SYS_REFCURSOR, nRETURNCODE OUT NUMBER) AS BEGIN nRETURNCODE := 0; BEGIN OPEN DATA_REC FOR SELECT S.STUD_ID,S.NAME,A.STATUS FROM ATTENDANCE A,STUDENT S WHERE A.LEC_ID = (SELECT L.LEC_ID FROM LECTURE L WHERE L.TEACHER_ID = nTEACER_ID AND L.LEC_NUM = nLEC_NUM AND L.CLASS_ID = nCLASS_ID ) AND A.STUD_ID = S.STUD_ID; END; EXCEPTION WHEN OTHERS THEN nRETURNCODE := -18; END S_ATTENDANCE; PROCEDURE S_MYATTENDANCE( nSTUD_ID IN STUDENT.STUD_ID%TYPE, DATA_REC OUT SYS_REFCURSOR, nRETURNCODE OUT NUMBER) AS BEGIN nRETURNCODE := 0; BEGIN OPEN DATA_REC FOR SELECT ST.NAME,A.STUD_ID,A.STATUS,S.SUB_NAME,L.LEC_NUM FROM SUBJECT S,ATTENDANCE A,LECTURE L, STUDENT ST WHERE A.STUD_ID = nSTUD_ID AND A.LEC_ID = L.LEC_ID AND S.SUB_ID = L.SUB_ID AND ST.STUD_ID = nSTUD_ID; END; EXCEPTION WHEN OTHERS THEN nRETURNCODE := -18; END S_MYATTENDANCE; END PA_ATTENDANCE;