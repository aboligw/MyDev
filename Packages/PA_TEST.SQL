--------------------------------------------------------
--  File created - Thursday-February-15-2018   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Package PA_TEST
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VB"."PA_TEST" 
AS
  PROCEDURE I_TEST(
      nSUB_ID     IN TEST.SUB_ID%TYPE,
      nTOT_MKS IN TEST.TOT_MKS%TYPE,
      nCLASS_ID   IN TEST.CLASS_ID%TYPE,
      nRETURNCODE OUT NUMBER);
      
        PROCEDURE S_TEST(
      nSUB_ID     IN TEST.SUB_ID%TYPE,
      nCLASS_ID   IN TEST.CLASS_ID%TYPE,
      nTEST_NUM   IN TEST.TEST_NUM%TYPE,
      nTEST_ID    OUT TEST.TEST_ID%TYPE,
      nRETURNCODE OUT NUMBER);
      
END PA_TEST;

/


create or replace PACKAGE BODY PA_TEST AS PROCEDURE I_TEST( nSUB_ID IN TEST.SUB_ID%TYPE, nTOT_MKS IN TEST.TOT_MKS%TYPE, nCLASS_ID IN TEST.CLASS_ID%TYPE, nRETURNCODE OUT NUMBER) AS X NUMBER; BEGIN BEGIN SELECT TEST_ID_SEQ.NEXTVAL INTO X FROM DUAL; nRETURNCODE:=0; BEGIN INSERT INTO TEST VALUES ( X, nSUB_ID, nTOT_MKS, nCLASS_ID, (SELECT NVL(MAX(TEST_NUM),0)+1 FROM TEST WHERE CLASS_ID = nCLASS_ID AND SUB_ID = nSUB_ID ) ) ; END; EXCEPTION WHEN OTHERS THEN nRETURNCODE := -19; END; END I_TEST; PROCEDURE S_TEST( nSUB_ID IN TEST.SUB_ID%TYPE, nCLASS_ID IN TEST.CLASS_ID%TYPE, nTEST_NUM IN TEST.TEST_NUM%TYPE, nTEST_ID OUT TEST.TEST_ID%TYPE, nRETURNCODE OUT NUMBER) AS BEGIN BEGIN nRETURNCODE := 0; SELECT TEST_ID INTO nTEST_ID FROM TEST WHERE nSUB_ID = SUB_ID AND nCLASS_ID = CLASS_ID AND nTEST_NUM = TEST_NUM; EXCEPTION WHEN OTHERS THEN nRETURNCODE := -20; END; END S_TEST; END PA_TEST;/